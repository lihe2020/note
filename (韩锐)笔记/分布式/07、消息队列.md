面试过程中如果提到消息队列，应当说出消息队列的特点。

### 1. 消息队列的作用

- 异步/解耦，避免业务之间的强依赖，上游只发出事件通知，并不关心下游是谁或者做怎么的处理
- 流量消峰/限流，将所有的请求发送到消息队列，然后消费者按照自己的速度消费，避免消费者承受过多的流量导致瘫痪
- 广播机制，例如salt stack就是利用zeromq来广播待执行的命令，各节点接受到命名后按照自己的需求去执行命令
- 日志处理，负责日志数据的存储
- 点对点通信，或者rpc
- 定时任务，延迟消费
- 事务最终一致性，类似于支付扣款这种场景，通常会借助于消息队列来实现最终一致性

### 2. 消息队列需要考虑的问题

- 消息的顺序性：大部分消息队列做不到这点，rabbitmq的消息的TTL属性导致消息不是顺序的，kafka只能做到分区有序性
- 如何保证消息不丢失：生产者需要acks=all，broker需要冗余备份，消费者需要手动提交位移
- 容错能力：kafka中消费失败需要手动重试；Rabbitmq中有死信队列
- 如何保证消息的幂等性：生产者发送消息需要提供唯一id；消费者需要根据业务判断重复
- 吞吐量：生产者异步发送消息，消费者并行消费
- 服务端消息堆积处理能力

### 3. 消息队列和定时任务有什么异同点



### 4. 参考

- https://tech.meituan.com/2016/07/01/mq-design.html